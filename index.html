<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS JQUERY -->
    <link rel="stylesheet" href="style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>Nöbetçi Eczane</title>
</head>

<body class="">
    <div class="container">
        <div class="row">
            <div class="d-flex flex-column">
                
                <!-- HEADER -->
                <div class="rounded mx-auto my-3 bg-warning">
                    <h2 class="fw-bold m-auto p-3 text-center">Nöbetçi Eczane Uygulaması</h2>
                </div>
                <!-- HEADER END-->
                
                <!-- INPUT FIELDS -->
                <div class="d-flex flex-column justify-content-around align-items-center">
                    
                    <input class="rounded border border-danger mx-auto my-2 w-50 p-2" type="text" id="ilText"
                        placeholder="  İl Giriniz" required>
                    <input class="rounded border border-danger mx-auto my-2 w-50 p-2" type="text" id="ilceText"
                        placeholder="  İlce Giriniz" />
                    <button class="rounded mx-auto my-2 border-secondary px-3" id="il">Tamam</button>
                    <br>
                    <button class="rounded-pill border border-light bg-danger text-light p-2 w-75" id="button1">Nöbetçi
                        Eczaneleri Sırala</button>
                </div>
                <!-- INPUT FIELDS END-->

                <!-- TABLE -->
                <div id="tableFixHead">
                    <table class="table table-striped bg-transparent rounded my-2 overflow-scroll">
                        <thead class="sticky-top bg-warning">
                            <tr>
                                <th>Eczane İsmi</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- ECZANELER -->
                        </tbody>
                    </table>
                </div>
                <!-- TABLE END-->

                <div class="mx-auto">
                    <p class="fw-bold">Nöbetçi eczana sayısı: </p>
                </div>


            </div>
        </div>
    </div>

    <!-- SCRİPT -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>

        $(document).ready(function () {
            var pharUrl = "https://api.collectapi.com/health/dutyPharmacy";

            $("#il").click(function (e) {
                $("#ilText").val(function (index, currentvalue) {
                    $("#ilceText").val(function (index, ilce) {
                        pharUrl += "?il=" + currentvalue + "&ilce=" + ilce;
                    });
                });
            });

            $("#button1").click(function () {
                $('.table').show();
                $.ajax({
                    type: "GET",
                    url: pharUrl,
                    dataType: 'json',
                    headers: {
                        "Authorization": "apikey " + "661a53NS8JW10Xp0tmqNr4:4rsFrfN8VQgHjtTuoV73Vb"
                    },
                    data: { get_param: 'value' },
                    success: function (result) {
                        var i = 0;
                        $.each(result.result, function () {
                            $("tbody").append("<tr><td class='fw-bold'>" + this.name + "</td></tr>");
                        })
                        $("p").append(JSON.stringify(result.result.length));
                    }
                });
            });
        });
    </script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- SCRİPT END-->

</body>

</html>